(function(window){"use strict";var Ajax=function(){};function makeXHR(){if(!window.XMLHttpRequest){return new window.ActiveXObject("Microsoft.XMLHTTP")}else if(window.XMLHttpRequest){return new XMLHttpRequest}}Ajax.prototype.send=function(args,callback){if(typeof args==="function"){callback=args;args.verb=this.verb;args.url_var=this.url_var;args.url=this.url;args.json=this.parse_json;typeof this.set_headers!=="undefined"&&(args.headers=this.set_headers);typeof this.progress_callback!=="undefined"&&(args.progress=this.progress_callback);typeof this.error_callback!=="undefined"&&(args.error=this.error_callback)}typeof args.url==="undefined"&&(args.url=window.location.href);if(typeof args==="undefined"||typeof callback==="undefined"){if(typeof args==="undefined"){throw"Missing arguments"}if(typeof callback==="undefined"){throw"Missing callback"}}else{typeof args.json==="undefined"&&(args.json=false);if(typeof args.verb==="undefined"||!args.verb.match(/^(get|post|put|delete)$/i)){args.verb="get"}}if(typeof args.url_var!=="undefined"){var parts=args.url_var;args.url_var="?";for(var i=0;i<Object.keys(parts).length;i++){var k=Object.keys(parts)[i];var v=parts[Object.keys(parts)[i]];if(i===0){args.url_var+=encodeURI(k)+"="+encodeURI(v)}else{args.url_var+="&"+encodeURI(k)+"="+encodeURI(v)}}args.url+=args.url_var}var req=makeXHR();if(typeof args.progress!=="undefined"){req.addEventListener("progress",args.progress,false)}if(typeof args.error!=="undefined"){req.addEventListener("error",args.error,false)}req.open(args.verb,args.url);if(typeof args.headers!=="undefined"){args.headers.forEach(function(value,key){req.setRequestHeader(key,value)})}req.onload=res;req.send();function res(){if(args.json===true){callback(JSON.parse(this.response),this.status)}else{callback(this.response,this.status)}}};function helperhelper(thisarg,json,verb,url,args,callback){if(typeof args==="undefined"&&typeof callback==="undefined"){thisarg.verb=verb;thisarg.parse_json=json;typeof url==="undefined"?thisarg.url=window.location.href:thisarg.url=url;return thisarg}else{typeof args==="function"&&(callback=args);if(typeof url==="object"){args=url}else{typeof url==="undefined"?args.url=window.location.href:args.url=url}args.verb=verb;args.json=json;return Ajax.prototype.send(args,callback)}}Ajax.prototype.post=function(url,args,callback){return helperhelper(this,false,"post",url,args,callback)};Ajax.prototype.get=function(url,args,callback){return helperhelper(this,false,"get",url,args,callback)};Ajax.prototype.put=function(url,args,callback){return helperhelper(this,false,"put",url,args,callback)};Ajax.prototype.delete=function(url,args,callback){return helperhelper(this,false,"delete",url,args,callback)};Ajax.prototype.postJSON=function(url,args,callback){return helperhelper(this,true,"post",url,args,callback)};Ajax.prototype.getJSON=function(url,args,callback){return helperhelper(this,true,"get",url,args,callback)};Ajax.prototype.putJSON=function(url,args,callback){return helperhelper(this,true,"put",url,args,callback)};Ajax.prototype.deleteJSON=function(url,args,callback){return helperhelper(this,true,"delete",url,args,callback)};Ajax.prototype.vars=function(vars){this.url_var=vars;return this};Ajax.prototype.json=function(json){typeof(json==="undefined")?this.parse_json=true:this.parse_json=json;return this};Ajax.prototype.headers=function(headers){this.set_headers=headers;return this};Ajax.prototype.progress=function(callback){this.progress_callback=callback;return this};Ajax.prototype.error=function(callback){this.error_callback=callback;return this};if(typeof window.ajax==="undefined"){Object.defineProperty(window,"ajax",{get:function(){return new Ajax}})}})(window);